"use strict";function _defineProperty(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e};!function($){new function e(){var n=this;_classCallCheck(this,e),this.addForm=function(e){var i=n.list.find("tr:first-child");i.length?i.is(".no-items")?i.replaceWith($(n.cloneForm())):i.is(".apison-form")||(n.removeForm(),$(n.cloneForm()).insertBefore(i)):n.list.html($(n.cloneForm()))},this.editForm=function(e){e.preventDefault();var i=$(e.target).parents("tr");n.removeForm(),$(n.cloneForm()).insertAfter(i),n.populateForm(i),n.list.find(".apison-delete").removeClass("hidden")},this.removeForm=function(){n.list.find(".apison-form").remove()},this.cloneForm=function(){return n.wrapper.find(".apison-form").clone(!0)},this.populateForm=function(e){var i=n.list.find(".apison-form");e.find("input[type=hidden]").each(function(){var e=i.find('.apison-input[name="'+$(this).attr("name")+'"]');e.is("input:checkbox")&&!$(this).val()?e.removeAttr("checked"):e.val($(this).val())}),i.find("input[name=id]").val(e.find("input[name=slug]").val())},this.save=function(e){e.preventDefault();var i=$(e.target),a=i.find(".spinner"),t=i.find(".apison-save"),s=i.find(".apison-notice"),r=i.serializeArray().reduce(function(e,n){return _extends({},e,_defineProperty({},n.name,n.value))},{});a.addClass("is-active"),t.attr("disabled","disabled");var o=$.ajax({url:ajaxurl,dataType:"json",data:{nonce:apison.nonce,action:"apison_save",fields:r}});o.done(function(e){var i=e.status,a=e.data,t=e.message;"success"===i?(n.removeForm(),n.updateRow({formData:r,data:a})):(s.find(".error").html(t),s.removeClass("hidden").addClass("notice"))}),o.fail(function(e){s.removeClass("hidden").addClass("notice")}),o.always(function(e){t.removeAttr("disabled"),a.removeClass("is-active")})},this.delete=function(e){var i=$(e.target).parents(".apison-form"),a=i.find(".spinner"),t=i.find(".apsion-delete"),s=i.find(".apison-notice"),r=i.find(".apison-confirm"),o=i.find("input[name=id]").val();if(r.hasClass("hidden"))r.removeClass("hidden");else{a.addClass("is-active"),t.attr("disabled","disabled");var d=$.ajax({url:ajaxurl,dataType:"json",data:{id:o,nonce:apison.nonce,action:"apison_delete"}});d.done(function(e){var i=e.status,a=e.message;"success"===i?(n.removeForm(),n.removeRow(o)):(s.find(".error").html(a),s.removeClass("hidden").addClass("notice"))}),d.fail(function(e){s.removeClass("hidden").addClass("notice")}),d.always(function(e){t.removeAttr("disabled"),a.removeClass("is-active")})}},this.updateRow=function(e){var i=e.formData.id,a=void 0===i?null:i,t=e.data;a?n.list.find("input[name='slug'][value='"+a+"']").parents("tr").replaceWith(t):n.list.prepend(t)},this.removeRow=function(e){n.list.find("input[name='slug'][value='"+e+"']").parents("tr").remove()},this.wrapper=$("#apison"),this.list=$("#the-list"),this.wrapper.on("click",".apison-add",this.addForm),this.wrapper.on("click",".apison-edit",this.editForm),this.wrapper.on("click",".apison-cancel",this.removeForm),this.wrapper.on("submit",".apison-form",this.save),this.wrapper.on("click",".apison-delete",this.delete)}}(jQuery);
//# sourceMappingURL=./scripts.min.js.map